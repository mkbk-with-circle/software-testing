Incorrectly assumes x is greater than or equal to max(seq)