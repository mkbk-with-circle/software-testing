Potential bug: It assumes that a unique day is indicated by a counter value of 1, but it may not cover all scenarios