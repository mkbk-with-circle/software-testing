Returning prematurely inside the while loop