Removing elements while iterating may cause unexpected behavior