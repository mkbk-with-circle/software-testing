It is unclear whether negative values are allowed in the 'seq' list. If not, this condition should be removed.