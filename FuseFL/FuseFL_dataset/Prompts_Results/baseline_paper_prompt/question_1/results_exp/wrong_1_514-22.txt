Inefficient use of 'max(seq)' in each iteration of the loop