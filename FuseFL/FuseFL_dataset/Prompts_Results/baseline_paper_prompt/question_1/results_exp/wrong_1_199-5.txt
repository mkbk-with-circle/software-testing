Assumes that seq is non-empty, but it doesn't explicitly check for that.